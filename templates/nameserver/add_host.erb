#!/bin/bash
HOST=$1
IP=$2
if test -z "$HOST" -o -z "$IP"
then
  echo "Usage: $0 <hostname> <ip>" >&2
  echo
  echo "Example: $0 puppet 10.0.0.1" >&2
  echo
  exit 1
fi
<% _backend = scope.lookupvar("pdns::nameserver::config::backend") -%>
<% if _backend == "postgresql" -%>
su -c "echo '$HOST A $IP' | /var/pdns/add_host_entries" postgres
<% else -%>
echo "$HOST A $IP" | /var/pdns/add_host_entries
<% end -%>
printf "Restarting name server: "
pdns_control cycle
